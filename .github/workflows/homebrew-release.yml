name: Bump Homebrew formulae on release

on:
  release:
    types: [published]
  workflow_dispatch:
    inputs:
      version:
        description: 'Version tag (e.g., v1.5.5)'
        required: true
        type: string

jobs:
  bump-homebrew-formula:
    name: Bump Homebrew formulae
    runs-on: ubuntu-latest
    steps:
      - name: Bump pixlet Homebrew formula
        uses: dawidd6/action-homebrew-bump-formula@v5
        with:
          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}
          formula: pixlet
          tap: tronbyt/homebrew-tronbyt
          tag: ${{ inputs.version || github.ref_name }}
          revision: ${{ github.sha }}
          force: false
          no_fork: true
      - name: Bump libpixlet Homebrew formula
        uses: dawidd6/action-homebrew-bump-formula@v5
        with:
          token: ${{ secrets.HOMEBREW_BUMP_TOKEN }}
          formula: libpixlet
          tap: tronbyt/homebrew-tronbyt
          tag: ${{ inputs.version || github.ref_name }}
          revision: ${{ github.sha }}
          force: false
          no_fork: true
